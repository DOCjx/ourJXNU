!function($){"use strict";String.prototype.repl=function(e,i){return this.split(e).join(i)};var e=function(e){var i,t=document.createElement("div");return t.innerHTML="<!--[if IE "+e+"]><i></i><![endif]-->",i=1===t.getElementsByTagName("i").length,document.body.appendChild(t),t.parentNode.removeChild(t),i},i={data:{},init:function(e){var t=e.initialPreview,a=e.id;t.length>0&&!z(t)&&(t=t.split(e.initialPreviewDelimiter)),i.data[a]={content:t,config:e.initialPreviewConfig,tags:e.initialPreviewThumbTags,delimiter:e.initialPreviewDelimiter,template:e.previewGenericTemplate,msg:function(i){return e.getMsgSelected(i)},initId:e.previewInitId,footer:e.getLayoutTemplate("footer"),isDelete:e.initialPreviewShowDelete,caption:e.initialCaption,actions:function(i,t,a,n,r){return e.renderFileActions(i,t,a,n,r)}}},fetch:function(e){return i.data[e].content.filter(function(e){return null!==e})},count:function(e,t){return i.data[e]&&i.data[e].content?t?i.data[e].content.length:i.fetch(e).length:0},get:function(e,t,a){var n,r="init_"+t,l=i.data[e],o=l.initId+"-"+r;return a=void 0===a||a,null===l.content[t]?"":(n=l.template.repl("{previewId}",o).repl("{frameClass}"," file-preview-initial").repl("{fileindex}",r).repl("{content}",l.content[t]).repl("{footer}",i.footer(e,t,a)),l.tags.length&&l.tags[t]&&(n=_(n,l.tags[t])),n)},add:function(e,t,a,n,r){var l,o=$.extend(!0,{},i.data[e]);return z(t)||(t=t.split(o.delimiter)),r?(l=o.content.push(t)-1,o.config[l]=a,o.tags[l]=n):(l=t.length,o.content=t,o.config=a,o.tags=n),i.data[e]=o,l},set:function(e,t,a,n,r){var l,o=$.extend(!0,{},i.data[e]);if(z(t)||(t=t.split(o.delimiter)),r){for(l=0;l<t.length;l++)o.content.push(t[l]);for(l=0;l<a.length;l++)o.config.push(a[l]);for(l=0;l<n.length;l++)o.tags.push(n[l])}else o.content=t,o.config=a,o.tags=n;i.data[e]=o},unset:function(e,t){var a=i.count(e);if(a){if(1===a)return i.data[e].content=[],void(i.data[e].config=[]);i.data[e].content[t]=null,i.data[e].config[t]=null}},out:function(e){var t,a="",n=i.data[e],r=i.count(e,!0);if(0===r)return{content:"",caption:""};for(var l=0;l<r;l++)a+=i.get(e,l);return t=n.msg(i.count(e)),{content:a,caption:t}},footer:function(e,t,a){var n=i.data[e];if(a=void 0===a||a,0===n.config.length||R(n.config[t]))return"";var r=n.config[t],l=M("caption",r)?r.caption:"",o=M("width",r)?r.width:"auto",s=!!M("url",r)&&r.url,d=M("key",r)?r.key:null,c=s===!1&&a,p=n.isDelete?n.actions(!1,!0,c,s,d):"",u=n.footer.repl("{actions}",p);return u.repl("{caption}",l).repl("{width}",o).repl("{indicator}","").repl("{indicatorTitle}","")}},t=function(e,i){return i=i||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?i:e)},a=function(){return window.File&&window.FileReader},n=function(){var i=document.createElement("div");return!e(9)&&(void 0!==i.draggable||void 0!==i.ondragstart&&void 0!==i.ondrop)},r=function(){return a&&window.FormData},l=function(e,i){e.removeClass(i).addClass(i)},o='style="width:{width};height:{height};"',s='      <param name="controller" value="true" />\n      <param name="allowFullScreen" value="true" />\n      <param name="allowScriptAccess" value="always" />\n      <param name="autoPlay" value="false" />\n      <param name="autoStart" value="false" />\n      <param name="quality" value="high" />\n',d='<div class="file-preview-other">\n       {previewFileIcon}\n   </div>',c={removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign file-icon-large text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."},p='{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>',u='{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',f='<div class="file-preview {class}">\n    <div class="close fileinput-remove">&times;</div>\n    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',v='<span class="glyphicon glyphicon-file kv-caption-icon"></span>',h='<div tabindex="-1" class="form-control file-caption {class}">\n   <span class="file-caption-ellipsis">&hellip;</span>\n   <div class="file-caption-name"></div>\n</div>',m='<div id="{id}" class="modal fade">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n        <h3 class="modal-title">Detailed Preview <small>{title}</small></h3>\n      </div>\n      <div class="modal-body">\n        <textarea class="form-control" style="font-family:Monaco,Consolas,monospace; height: {height}px;" readonly>{body}</textarea>\n      </div>\n    </div>\n  </div>\n</div>',g='<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {percent}%\n     </div>\n</div>',w='<div class="file-thumbnail-footer">\n    <div class="file-caption-name">{caption}</div>\n    {actions}\n</div>',b='<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload}{delete}{other}    </div>\n    <div class="file-upload-indicator" tabindex="-1" title="{indicatorTitle}">{indicator}</div>\n    <div class="clearfix"></div>\n</div>',x='<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}"{dataUrl}{dataKey}>{removeIcon}</button>\n',C='<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">   {uploadIcon}\n</button>\n',y='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   {content}\n   {footer}\n</div>\n',T='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n    <object data="{data}" type="{type}" width="{width}" height="{height}">\n       '+d+"\n    </object>\n   {footer}\n</div>",E='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   <img src="{data}" class="file-preview-image" title="{caption}" alt="{caption}" '+o+">\n   {footer}\n</div>\n",F='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   <div class="file-preview-text" title="{caption}" '+o+">\n       {data}\n   </div>\n   {footer}\n</div>",k='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+o+'>\n   <video width="{width}" height="{height}" controls>\n       <source src="{data}" type="{type}">\n       '+d+"\n   </video>\n   {footer}\n</div>\n",I='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+o+'>\n   <audio controls>\n       <source src="{data}" type="{type}">\n       '+d+"\n   </audio>\n   {footer}\n</div>",D='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+o+'>\n   <object type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+s+"       "+d+"\n   </object>\n   {footer}\n</div>\n",P='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+o+'>\n   <object data="{data}" type="{type}" width="{width}" height="{height}">\n       <param name="movie" value="{caption}" />\n'+s+"         "+d+"\n   </object>\n   {footer}\n</div>",S='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+o+">\n   "+d+"\n   {footer}\n</div>",U={main1:p,main2:u,preview:f,icon:v,caption:h,modal:m,progress:g,footer:w,actions:b,actionDelete:x,actionUpload:C},j={generic:y,html:T,image:E,text:F,video:k,audio:I,flash:D,object:P,other:S},A=["image","html","text","video","audio","flash","object"],L={image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"160px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"213px",height:"80px"},flash:{width:"213px",height:"160px"},object:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}},O={image:function(e,i){return void 0!==e?e.match("image.*"):i.match(/\.(gif|png|jpe?g)$/i)},html:function(e,i){return void 0!==e?"text/html"===e:i.match(/\.(htm|html)$/i)},text:function(e,i){return void 0!==e&&e.match("text.*")||i.match(/\.(txt|md|csv|nfo|php|ini)$/i)},video:function(e,i){return void 0!==e&&e.match(/\.video\/(ogg|mp4|webm)$/i)||i.match(/\.(og?|mp4|webm)$/i)},audio:function(e,i){return void 0!==e&&e.match(/\.audio\/(ogg|mp3|wav)$/i)||i.match(/\.(ogg|mp3|wav)$/i)},flash:function(e,i){return void 0!==e&&"application/x-shockwave-flash"===e||i.match(/\.(swf)$/i)},object:function(){return!0},other:function(){return!0}},R=function(e,i){return null===e||void 0===e||0===e.length||i&&""===$.trim(e)},z=function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},M=function(e,i){return"object"==typeof i&&e in i},B=function(e,i,t){return R(e)||R(e[i])?t:$(e[i])},N=function(){return Math.round((new Date).getTime()+100*Math.random())},Z=function(e){return String(e).repl("&","&amp;").repl('"',"&quot;").repl("'","&#39;").repl("<","&lt;").repl(">","&gt;")},_=function(e,i){var t=e;return i=i||{},$.each(i,function(e,i){"function"==typeof i&&(i=i()),t=t.repl(e,i)}),t},q=window.URL||window.webkitURL,H=function(i,t){var n=this;n.$element=$(i),n.validate()&&(a()||e(9)?(n.init(t),n.listen()):n.$element.removeClass("file-loading"))};H.prototype={constructor:H,validate:function(){var e,i=this;return"file"===i.$element.attr("type")||(e='<div class="help-block alert alert-warning"><h4>Invalid Input Type</h4>You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.</div>',i.$element.after(e),!1)},init:function(a){var o,s=this,d=s.$element;$.each(a,function(e,i){s[e]="maxFileCount"===e||"maxFileSize"===e?t(i):i}),s.fileInputCleared=!1,s.fileBatchCompleted=!0,R(s.allowedPreviewTypes)&&(s.allowedPreviewTypes=A),s.uploadFileAttr=R(d.attr("name"))?"file_data":d.attr("name"),s.reader=null,s.formdata={},s.isIE9=e(9),s.isIE10=e(10),s.filestack=[],s.ajaxRequests=[],s.isError=!1,s.ajaxAborted=!1,s.dropZoneEnabled=n()&&s.dropZoneEnabled,s.isDisabled=s.$element.attr("disabled")||s.$element.attr("readonly"),s.isUploadable=r&&!R(s.uploadUrl),s.slug="function"==typeof a.slugCallback?a.slugCallback:s.slugDefault,s.mainTemplate=s.showCaption?s.getLayoutTemplate("main1"):s.getLayoutTemplate("main2"),s.captionTemplate=s.getLayoutTemplate("caption"),s.previewGenericTemplate=s.getPreviewTemplate("generic"),R(s.$element.attr("id"))&&s.$element.attr("id",N()),void 0===s.$container?s.$container=s.createContainer():s.refreshContainer(),s.$progress=s.$container.find(".kv-upload-progress"),s.$btnUpload=s.$container.find(".kv-fileinput-upload"),s.$captionContainer=B(a,"elCaptionContainer",s.$container.find(".file-caption")),s.$caption=B(a,"elCaptionText",s.$container.find(".file-caption-name")),s.$previewContainer=B(a,"elPreviewContainer",s.$container.find(".file-preview")),s.$preview=B(a,"elPreviewImage",s.$container.find(".file-preview-thumbnails")),s.$previewStatus=B(a,"elPreviewStatus",s.$container.find(".file-preview-status")),s.$errorContainer=B(a,"elErrorContainer",s.$previewContainer.find(".kv-fileinput-error")),R(s.msgErrorClass)||l(s.$errorContainer,s.msgErrorClass),s.$errorContainer.hide(),s.fileActionSettings=$.extend(c,a.fileActionSettings),s.previewInitId="preview-"+N(),s.id=s.$element.attr("id"),i.init(s),s.initPreview(!0),s.initPreviewDeletes(),s.options=a,s.setFileDropZoneTitle(),s.uploadCount=0,s.uploadPercent=0,s.$element.removeClass("file-loading"),o=s.getLayoutTemplate("progress"),s.progressTemplate=o.replace("{class}",s.progressClass),s.progressCompleteTemplate=o.replace("{class}",s.progressCompleteClass),s.setEllipsis()},parseError:function(e,i,t){var a=this,n=$.trim(i+""),r="."===n.slice(-1)?"":".",l=$(e.responseText).text();return a.showAjaxErrorDetails?(l=$.trim(l.replace(/\n\s*\n/g,"\n")),l=l.length>0?"<pre>"+l+"</pre>":"",n+=r+l):n+=r,t?"<b>"+t+": </b>"+e:n},raise:function(e,i){var t=this,a=$.Event(e),n=!1;if(void 0!==i?t.$element.trigger(a,i):t.$element.trigger(a),a.result&&(n=!0),n)switch(e){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":break;default:t.ajaxAborted=n}},getLayoutTemplate:function(e){var i=this,t=M(e,i.layoutTemplates)?i.layoutTemplates[e]:U[e];return R(i.customLayoutTags)?t:_(t,i.customLayoutTags)},getPreviewTemplate:function(e){var i=this,t=M(e,i.previewTemplates)?i.previewTemplates[e]:j[e];return t=t.repl("{previewFileIcon}",i.previewFileIcon),R(i.customPreviewTags)?t:_(t,i.customPreviewTags)},getOutData:function(e,i,t){var a=this;return e=e||{},i=i||{},t=t||a.filestack.slice(0)||{},{form:a.formdata,files:t,extra:a.getExtraData(),response:i,reader:a.reader,jqXHR:e}},setEllipsis:function(){var e=this,i=e.$captionContainer,t=e.$caption,a=t.clone().css("height","auto").hide();i.parent().before(a),i.removeClass("kv-has-ellipsis"),a.outerWidth()>t.outerWidth()&&i.addClass("kv-has-ellipsis"),a.remove()},listen:function(){var e=this,i=e.$element,t=e.$captionContainer,a=e.$btnFile,n=i.closest("form");i.on("change",$.proxy(e.change,e)),$(window).on("resize",function(){e.setEllipsis()}),a.off("click").on("click",function(){e.raise("filebrowse"),e.isError&&!e.isUploadable&&e.clear(),t.focus()}),n.off("reset").on("reset",$.proxy(e.reset,e)),e.$container.off("click").on("click",".fileinput-remove:not([disabled])",$.proxy(e.clear,e)).on("click",".fileinput-cancel",$.proxy(e.cancel,e)),e.isUploadable&&e.dropZoneEnabled&&e.showPreview&&e.initDragDrop(),e.isUploadable||n.on("submit",$.proxy(e.submitForm,e)),e.$container.find(".kv-fileinput-upload").off("click").on("click",function(i){e.isUploadable&&(i.preventDefault(),!$(this).hasClass("disabled")&&R($(this).attr("disabled"))&&e.upload())})},submitForm:function(){var e=this,i=e.$element,t=i.get(0).files;return t&&t.length<e.minFileCount&&e.minFileCount>0?(e.noFilesError({}),!1):!e.abort({})},abort:function(e){var i,t=this;return!(!t.ajaxAborted||"object"!=typeof t.ajaxAborted||void 0===t.ajaxAborted.message)&&(i=void 0!==t.ajaxAborted.data?t.getOutData({},t.ajaxAborted.data):t.getOutData(),i=$.extend(i,e),t.showUploadError(t.ajaxAborted.message,i,"filecustomerror"),!0)},noFilesError:function(e){var i=this,t=i.minFileCount>1?i.filePlural:i.fileSingle,a=i.msgFilesTooLess.repl("{n}",i.minFileCount).repl("{files}",t),n=i.$errorContainer;n.html(a),i.isError=!0,i.updateFileDetails(0),n.fadeIn(800),i.raise("fileerror",[e]),i.clearFileInput(),l(i.$container,"has-error")},setProgress:function(e){var i=this,t=Math.min(e,100),a=t<100?i.progressTemplate:i.progressCompleteTemplate;i.$progress.html(a.repl("{percent}",t))},upload:function(){var e,i,t,a=this,n=a.getFileStack().length,r={},l=!$.isEmptyObject(a.getExtraData());if(n<a.minFileCount&&a.minFileCount>0)return void a.noFilesError(r);if(a.isUploadable&&!a.isDisabled&&(0!==n||l)){if(a.resetUpload(),a.$progress.removeClass("hide"),a.uploadCount=0,a.uploadPercent=0,a.lock(),a.setProgress(0),0===n&&l)return void a.uploadExtraOnly();if(t=a.filestack.length,a.hasInitData=!1,a.uploadAsync&&a.showPreview)for(i=a.getOutData(),a.raise("filebatchpreupload",[i]),a.fileBatchCompleted=!1,a.uploadCache={content:[],config:[],tags:[],append:!0},e=0;e<t;e+=1)void 0!==a.filestack[e]&&a.uploadSingle(e,a.filestack,!0);else a.uploadBatch()}},lock:function(){var e=this;e.resetErrors(),e.disable(),e.showRemove&&l(e.$container.find(".fileinput-remove"),"hide"),e.showCancel&&e.$container.find(".fileinput-cancel").removeClass("hide"),e.raise("filelock",[e.filestack,e.getExtraData()])},unlock:function(e){var i=this;void 0===e&&(e=!0),i.enable(),i.showCancel&&l(i.$container.find(".fileinput-cancel"),"hide"),i.showRemove&&i.$container.find(".fileinput-remove").removeClass("hide"),e&&i.resetFileStack(),i.raise("fileunlock",[i.filestack,i.getExtraData()])},resetFileStack:function(){var e=this,i=0,t=[];e.getThumbs().each(function(){var a=$(this),n=a.attr("data-fileindex"),r=e.filestack[n];n!==-1&&(void 0!==r?(t[i]=r,a.attr({id:e.previewInitId+"-"+i,"data-fileindex":i}),i+=1):a.attr({id:"uploaded-"+N(),"data-fileindex":"-1"}))}),e.filestack=t},refresh:function(e){var i,t=this,a=t.$element,n=arguments.length?$.extend(t.options,e):t.options;a.off(),t.init(n),i=t.$container.find(".file-drop-zone"),i.off("dragenter dragover drop"),$(document).off("dragenter dragover drop"),t.listen(),t.setFileDropZoneTitle()},initDragDrop:function(){var e=this,i=e.$container.find(".file-drop-zone");i.off("dragenter dragover drop"),$(document).off("dragenter dragover drop"),i.on("dragenter dragover",function(i){i.stopPropagation(),i.preventDefault(),e.isDisabled||l($(this),"highlighted")}),i.on("dragleave",function(i){i.stopPropagation(),i.preventDefault(),e.isDisabled||$(this).removeClass("highlighted")}),i.on("drop",function(i){i.preventDefault(),e.isDisabled||(e.change(i,"dragdrop"),$(this).removeClass("highlighted"))}),$(document).on("dragenter dragover drop",function(e){e.stopPropagation(),e.preventDefault()})},setFileDropZoneTitle:function(){var e=this,i=e.$container.find(".file-drop-zone");i.find("."+e.dropZoneTitleClass).remove(),e.isUploadable&&e.showPreview&&0!==i.length&&!(e.getFileStack().length>0)&&e.dropZoneEnabled&&(0===i.find(".file-preview-frame").length&&i.prepend('<div class="'+e.dropZoneTitleClass+'">'+e.dropZoneTitle+"</div>"),e.$container.removeClass("file-input-new"),l(e.$container,"file-input-ajax-new"))},initFileActions:function(){var e=this;e.$preview.find(".kv-file-remove").each(function(){var t,a,n=$(this),r=n.closest(".file-preview-frame"),l=r.attr("data-fileindex");n.off("click").on("click",function(){r.fadeOut("slow",function(){e.filestack[l]=void 0,e.clearObjects(r),r.remove();var n=e.getFileStack(),o=n.length,s=i.count(e.id);e.clearFileInput(),0===o&&0===s?e.reset():(t=s+o,a=t>1?e.getMsgSelected(t):n[0].name,e.setCaption(a))})})}),e.$preview.find(".kv-file-upload").each(function(){var i=$(this);i.off("click").on("click",function(){var t=i.closest(".file-preview-frame"),a=t.attr("data-fileindex");e.uploadSingle(a,e.filestack,!1)})})},getMsgSelected:function(e){var i=this,t=1===e?i.fileSingle:i.filePlural;return i.msgSelected.repl("{n}",e).repl("{files}",t)},renderFileFooter:function(e,i){var t,a,n=this,r=n.fileActionSettings,l=n.getLayoutTemplate("footer");return n.isUploadable?(t=l.repl("{actions}",n.renderFileActions(!0,!0,!1,!1,!1)),a=t.repl("{caption}",e).repl("{width}",i).repl("{indicator}",r.indicatorNew).repl("{indicatorTitle}",r.indicatorNewTitle)):a=l.repl("{actions}","").repl("{caption}",e).repl("{width}",i).repl("{indicator}","").repl("{indicatorTitle}",""),a=_(a,n.previewThumbTags)},renderFileActions:function(e,i,t,a,n){if(!e&&!i)return"";var r=this,l=a===!1?"":' data-url="'+a+'"',o=n===!1?"":' data-key="'+n+'"',s=r.getLayoutTemplate("actionDelete"),d="",c=r.getLayoutTemplate("actions"),p=r.otherActionButtons.repl("{dataKey}",o),u=r.fileActionSettings,f=t?u.removeClass+" disabled":u.removeClass;return s=s.repl("{removeClass}",f).repl("{removeIcon}",u.removeIcon).repl("{removeTitle}",u.removeTitle).repl("{dataUrl}",l).repl("{dataKey}",o),e&&(d=r.getLayoutTemplate("actionUpload").repl("{uploadClass}",u.uploadClass).repl("{uploadIcon}",u.uploadIcon).repl("{uploadTitle}",u.uploadTitle)),c.repl("{delete}",s).repl("{upload}",d).repl("{other}",p)},initPreview:function(e){var t,a=this,n=a.initialCaption||"";return i.count(a.id)?(t=i.out(a.id),n=e&&a.initialCaption?a.initialCaption:t.caption,a.$preview.html(t.content),a.setCaption(n),void(R(t.content)||a.$container.removeClass("file-input-new"))):(a.$preview.html(""),void(e?a.setCaption(n):a.initCaption()))},initPreviewDeletes:function(){var e=this,t=e.deleteExtraData||{},a=function(){0===e.$preview.find(".kv-file-remove").length&&(e.reset(),e.initialCaption="")};e.$preview.find(".kv-file-remove").each(function(){var n=$(this),r=n.data("url")||e.deleteUrl,o=n.data("key");if(!R(r)&&void 0!==o){var s,d,c,p,u=n.closest(".file-preview-frame"),f=i.data[e.id],v=u.data("fileindex");v=parseInt(v.replace("init_","")),c=R(f.config)&&R(f.config[v])?null:f.config[v],p=R(c)||R(c.extra)?t:c.extra,"function"==typeof p&&(p=p()),d={id:n.attr("id"),key:o,extra:p},s=$.extend({url:r,type:"DELETE",dataType:"json",data:$.extend({key:o},p),beforeSend:function(i){e.ajaxAborted=!1,e.raise("filepredelete",[o,i,p]),e.ajaxAborted?i.abort():(l(u,"file-uploading"),l(n,"disabled"))},success:function(t,r,l){var s,c;return void 0!==t&&void 0!==t.error?(d.jqXHR=l,d.response=t,e.showError(t.error,d,"filedeleteerror"),u.removeClass("file-uploading"),n.removeClass("disabled"),void a()):(i.unset(e.id,v),s=i.count(e.id),c=s>0?e.getMsgSelected(s):"",e.raise("filedeleted",[o,l,p]),e.setCaption(c),u.removeClass("file-uploading").addClass("file-deleted"),void u.fadeOut("slow",function(){e.clearObjects(u),u.remove(),a(),s||0!==e.getFileStack().length||(e.setCaption(""),e.reset())}))},error:function(i,t,n){var r=e.parseError(i,n);d.jqXHR=i,d.response={},e.showError(r,d,"filedeleteerror"),u.removeClass("file-uploading"),a()}},e.ajaxDeleteSettings),n.off("click").on("click",function(){$.ajax(s)})}})},clearObjects:function(e){e.find("video audio").each(function(){this.pause(),$(this).remove()}),e.find("img object div").each(function(){$(this).remove()})},clearFileInput:function(){var e,i,t,a=this,n=a.$element;R(n.val())||(a.isIE9||a.isIE10?(e=n.closest("form"),i=$(document.createElement("form")),t=$(document.createElement("div")),n.before(t),e.length?e.after(i):t.after(i),i.append(n).trigger("reset"),t.before(n).remove(),i.remove()):n.val(""),a.fileInputCleared=!0)},resetUpload:function(){var e=this;e.uploadCache={content:[],config:[],tags:[],append:!0},e.uploadCount=0,e.uploadPercent=0,e.$btnUpload.removeAttr("disabled"),e.setProgress(0),l(e.$progress,"hide"),e.resetErrors(!1),e.ajaxAborted=!1,e.ajaxRequests=[]},cancel:function(){var e,i=this,t=i.ajaxRequests,a=t.length;if(a>0)for(e=0;e<a;e+=1)t[e].abort();i.getThumbs().each(function(){var e=$(this),t=e.attr("data-fileindex");e.removeClass("file-uploading"),void 0!==i.filestack[t]&&(e.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),e.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),i.unlock()})},clear:function(){var e,t=this;t.$btnUpload.removeAttr("disabled"),t.resetUpload(),t.filestack=[],t.clearFileInput(),t.resetErrors(!0),t.raise("fileclear"),!t.overwriteInitial&&i.count(t.id)?(t.showFileIcon(),t.resetPreview(),t.setEllipsis(),t.initPreviewDeletes(),t.$container.removeClass("file-input-new")):(t.getThumbs().each(function(){t.clearObjects($(this))}),t.$preview.html(""),e=!t.overwriteInitial&&t.initialCaption.length>0?t.initialCaption:"",t.setCaption(e),t.setEllipsis(),t.$caption.attr("title",""),l(t.$container,"file-input-new")),0===t.$container.find(".file-preview-frame").length&&(t.initCaption()||t.$captionContainer.find(".kv-caption-icon").hide(),t.setEllipsis()),t.hideFileIcon(),t.raise("filecleared"),t.$captionContainer.focus(),t.setFileDropZoneTitle()},resetPreview:function(){var e,t=this;i.count(t.id)?(e=i.out(t.id),t.$preview.html(e.content),t.setCaption(e.caption)):(t.$preview.html(""),t.initCaption())},reset:function(){var e=this;e.clear(),e.resetPreview(),e.setEllipsis(),e.$container.find(".fileinput-filename").text(""),e.raise("filereset"),e.initialPreview.length>0&&e.$container.removeClass("file-input-new"),e.setFileDropZoneTitle(),e.filestack=[],e.formdata={}},disable:function(){var e=this;e.isDisabled=!0,e.raise("filedisabled"),e.$element.attr("disabled","disabled"),e.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),e.$container.find(".btn-file, .fileinput-remove, .kv-fileinput-upload").attr("disabled",!0),e.initDragDrop()},enable:function(){var e=this;e.isDisabled=!1,e.raise("fileenabled"),e.$element.removeAttr("disabled"),e.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),e.$container.find(".btn-file, .fileinput-remove, .kv-fileinput-upload").removeAttr("disabled"),e.initDragDrop()},getThumbs:function(e){return e=e||"",this.$preview.find(".file-preview-frame:not(.file-preview-initial)"+e)},getExtraData:function(){var e=this,i=e.uploadExtraData;return"function"==typeof e.uploadExtraData&&(i=e.uploadExtraData()),i},uploadExtra:function(){var e=this,i=e.getExtraData();0!==i.length&&$.each(i,function(i,t){e.formdata.append(i,t)})},initXhr:function(e,i){var t=this;return e.upload&&e.upload.addEventListener("progress",function(e){var a=0,n=e.loaded||e.position,r=e.total;e.lengthComputable&&(a=Math.ceil(n/r*i)),t.uploadPercent=Math.max(a,t.uploadPercent),t.setProgress(t.uploadPercent)},!1),e},ajaxSubmit:function(e,i,t,a){var n,r=this;r.uploadExtra(),n=$.extend({xhr:function(){var e=$.ajaxSettings.xhr();return r.initXhr(e,98)},url:r.uploadUrl,type:"POST",dataType:"json",data:r.formdata,cache:!1,processData:!1,contentType:!1,beforeSend:e,success:i,complete:t,error:a},r.ajaxSettings),r.ajaxRequests.push($.ajax(n))},initUploadSuccess:function(e,t,a){var n,r,l,o,s,d,c,p=this;"object"!=typeof e||$.isEmptyObject(e)||void 0!==e.initialPreview&&e.initialPreview.length>0&&(p.hasInitData=!0,s=e.initialPreview||[],d=e.initialPreviewConfig||[],c=e.initialPreviewThumbTags||[],n=!(void 0!==e.append&&!e.append),p.overwriteInitial=!1,void 0===t||a?a?(p.uploadCache.content.push(s[0]),p.uploadCache.config.push(d[0]),p.uploadCache.tags.push(c[0]),p.uploadCache.append=n):(i.set(p.id,s,d,c,n),p.initPreview(),p.initPreviewDeletes()):(l=i.add(p.id,s,d[0],c[0],n),r=i.get(p.id,l,!1),o=$(r).hide(),t.after(o).fadeOut("slow",function(){o.fadeIn("slow").css("display:inline-block"),p.initPreviewDeletes(),p.clearFileInput()})))},uploadSingle:function(e,t,a){var n,r,o,s,d,c,p,u,f,v,h=this,m=h.getFileStack().length,g=new FormData,w=h.previewInitId+"-"+e,b=$("#"+w+":not(.file-preview-initial)"),x=b.find(".kv-file-upload"),C=b.find(".kv-file-remove"),y=b.find(".file-upload-indicator"),T=h.fileActionSettings,E=h.filestack.length>0||!$.isEmptyObject(h.uploadExtraData),F={id:w,index:e};h.formdata=g,0===m||!E||x.hasClass("disabled")||h.abort(F)||(o=function(){var e=h.getThumbs(".file-uploading");e.length>0||h.fileBatchCompleted||(h.fileBatchCompleted=!0,setTimeout(function(){i.set(h.id,h.uploadCache.content,h.uploadCache.config,h.uploadCache.tags,h.uploadCache.append),h.hasInitData&&(h.initPreview(),h.initPreviewDeletes()),h.setProgress(100),h.unlock(),h.clearFileInput(),h.raise("filebatchuploadcomplete",[h.filestack,h.getExtraData()])},100))},s=function(e,i){y.html(T[e]),y.attr("title",T[i])},d=function(){!a||0===m||h.uploadPercent>=100||(h.uploadCount+=1,r=80+Math.ceil(20*h.uploadCount/m),h.uploadPercent=Math.max(r,h.uploadPercent),h.setProgress(h.uploadPercent),h.initPreviewDeletes())},c=function(){x.removeAttr("disabled"),C.removeAttr("disabled"),b.removeClass("file-uploading")},p=function(i){n=h.getOutData(i),s("indicatorLoading","indicatorLoadingTitle"),l(b,"file-uploading"),x.attr("disabled",!0),C.attr("disabled",!0),a||h.lock(),h.raise("filepreupload",[n,w,e]),F=$.extend(F,n),h.abort(F)&&(i.abort(),h.setProgress(100))},u=function(i,t,r){n=h.getOutData(r,i),F=$.extend(F,n),setTimeout(function(){void 0===i.error?(s("indicatorSuccess","indicatorSuccessTitle"),x.hide(),C.hide(),h.filestack[e]=void 0,h.raise("fileuploaded",[n,w,e]),h.initUploadSuccess(i,b,a),a||h.resetFileStack()):(s("indicatorError","indicatorErrorTitle"),h.showUploadError(i.error,F))},100)},f=function(){setTimeout(function(){d(),c(),a?o():h.unlock(!1)},100)},v=function(i,n,r){var l=h.parseError(i,r,a?t[e].name:null);s("indicatorError","indicatorErrorTitle"),F=$.extend(F,h.getOutData(i)),h.showUploadError(l,F)},g.append(h.uploadFileAttr,t[e]),g.append("file_id",e),h.ajaxSubmit(p,u,f,v))},uploadBatch:function(){var e,i,t,a,n,r,o,s,d=this,c=d.filestack,p=c.length,u=d.filestack.length>0||!$.isEmptyObject(d.uploadExtraData),f={};d.formdata=new FormData,0!==p&&u&&!d.abort(f)&&(e=d.fileActionSettings,i=function(i,t,a){var n=$("#"+d.previewInitId+"-"+i).find(".file-upload-indicator");n.html(e[t]),n.attr("title",e[a])},a=function(e){var i=$("#"+d.previewInitId+"-"+e+":not(.file-preview-initial)"),t=i.find(".kv-file-upload"),a=i.find(".kv-file-delete");i.removeClass("file-uploading"),t.removeAttr("disabled"),a.removeAttr("disabled")},t=function(){$.each(c,function(e){d.filestack[e]=void 0}),d.clearFileInput()},n=function(e){d.lock();var i=d.getOutData(e);d.showPreview&&d.getThumbs().each(function(){var e=$(this),i=e.find(".kv-file-upload"),t=e.find(".kv-file-remove");l(e,"file-uploading"),i.attr("disabled",!0),t.attr("disabled",!0)}),d.raise("filebatchpreupload",[i]),d.abort(i)&&e.abort()},r=function(e,n,r){var l=d.getOutData(r,e),o=d.getThumbs(),s=R(e.errorkeys)?[]:e.errorkeys;void 0===e.error||R(e.error)?(d.raise("filebatchuploadsuccess",[l]),t(),d.showPreview?(o.find(".kv-file-upload").hide(),o.find(".kv-file-remove").hide(),o.each(function(){var e=$(this),t=e.attr("data-fileindex");i(t,"indicatorSuccess","indicatorSuccessTitle"),a(t)}),d.initUploadSuccess(e)):d.reset()):(d.showPreview&&(o.each(function(){var e=$(this),t=parseInt(e.attr("data-fileindex"),10);return a(t),0===s.length?void i(t,"indicatorError","indicatorErrorTitle"):void($.inArray(t,s)!==-1?i(t,"indicatorError","indicatorErrorTitle"):(e.find(".kv-file-upload").hide(),e.find(".kv-file-remove").hide(),i(t,"indicatorSuccess","indicatorSuccessTitle"),d.filestack[t]=void 0))}),d.initUploadSuccess(e)),d.showUploadError(e.error,l,"filebatchuploaderror"))},o=function(){d.setProgress(100),d.unlock(),d.raise("filebatchuploadcomplete",[d.filestack,d.getExtraData()]),d.clearFileInput()},s=function(e,t,a){var n=d.getOutData(e),r=d.parseError(e,a);d.showUploadError(r,n,"filebatchuploaderror"),d.uploadFileCount=p-1,d.showPreview&&(d.getThumbs().each(function(){var e=$(this),t=e.attr("data-fileindex");e.removeClass("file-uploading"),void 0!==d.filestack[t]&&i(t,"indicatorError","indicatorErrorTitle")}),d.getThumbs().removeClass("file-uploading"),d.getThumbs(" .kv-file-upload").removeAttr("disabled"),d.getThumbs(" .kv-file-delete").removeAttr("disabled"))},$.each(c,function(e,i){R(c[e])||d.formdata.append(d.uploadFileAttr,i)}),d.ajaxSubmit(n,r,o,s))},uploadExtraOnly:function(){var e,i,t,a,n=this,r={};n.formdata=new FormData,n.abort(r)||(e=function(e){n.lock();var i=n.getOutData(e);n.raise("filebatchpreupload",[i]),n.setProgress(50),r.data=i,r.xhr=e,n.abort(r)&&(e.abort(),n.setProgress(100))},i=function(e,i,t){var a=n.getOutData(t,e);void 0===e.error||R(e.error)?(n.raise("filebatchuploadsuccess",[a]),n.clearFileInput(),n.initUploadSuccess(e)):n.showUploadError(e.error,a,"filebatchuploaderror")},t=function(){n.setProgress(100),n.unlock(),n.raise("filebatchuploadcomplete",[n.filestack,n.getExtraData()]),n.clearFileInput()},a=function(e,i,t){var a=n.getOutData(e),l=n.parseError(e,t);r.data=a,n.showUploadError(l,a,"filebatchuploaderror")},n.ajaxSubmit(e,i,t,a))},hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.find(".kv-caption-icon").hide();
},showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},resetErrors:function(e){var i=this,t=i.$errorContainer;i.isError=!1,i.$container.removeClass("has-error"),t.html(""),e?t.fadeOut("slow"):t.hide()},showFolderError:function(e){var i=this,t=i.$errorContainer;e&&(t.html(i.msgFoldersNotAllowed.repl("{n}",e)),t.fadeIn(800),l(i.$container,"has-error"),i.raise("filefoldererror",[e]))},showUploadError:function(e,i,t){var a=this,n=a.$errorContainer,r=t||"fileuploaderror";return 0===n.find("ul").length?n.html("<ul><li>"+e+"</li></ul>"):n.find("ul").append("<li>"+e+"</li>"),n.fadeIn(800),a.raise(r,[i]),l(a.$container,"has-error"),!0},showError:function(e,i,t){var a=this,n=a.$errorContainer,r=t||"fileerror";return i=i||{},i.reader=a.reader,n.html(e),n.fadeIn(800),a.raise(r,[i]),a.isUploadable||a.clearFileInput(),l(a.$container,"has-error"),a.$btnUpload.attr("disabled",!0),!0},errorHandler:function(e,i){var t=this,a=e.target.error;switch(a.code){case a.NOT_FOUND_ERR:t.showError(t.msgFileNotFound.repl("{name}",i));break;case a.SECURITY_ERR:t.showError(t.msgFileSecured.repl("{name}",i));break;case a.NOT_READABLE_ERR:t.showError(t.msgFileNotReadable.repl("{name}",i));break;case a.ABORT_ERR:t.showError(t.msgFilePreviewAborted.repl("{name}",i));break;default:t.showError(t.msgFilePreviewError.repl("{name}",i))}},parseFileType:function(e){var i,t,a,n,r=this;for(n=0;n<A.length;n+=1)if(a=A[n],i=M(a,r.fileTypeSettings)?r.fileTypeSettings[a]:O[a],t=i(e.type,e.name)?a:"",!R(t))return t;return"other"},previewDefault:function(e,i,t){if(this.showPreview){var a=this,n=q.createObjectURL(e),r=$("#"+i),l=a.previewSettings.other,o=a.renderFileFooter(e.name,l.width),s=a.getPreviewTemplate("other"),d=i.slice(i.lastIndexOf("-")+1),c="";t===!0&&(c=" btn disabled",o+='<div class="file-other-error text-danger"><i class="glyphicon glyphicon-exclamation-sign"></i></div>'),a.$preview.append("\n"+s.repl("{previewId}",i).repl("{frameClass}",c).repl("{fileindex}",d).repl("{caption}",a.slug(e.name)).repl("{width}",l.width).repl("{height}",l.height).repl("{type}",e.type).repl("{data}",n).repl("{footer}",o)),r.on("load",function(){q.revokeObjectURL(r.attr("data"))})}},previewFile:function(e,i,t,a){if(this.showPreview){var n,r,l,o,s=this,d=s.parseFileType(e),c=s.slug(e.name),p=s.allowedPreviewTypes,u=s.allowedPreviewMimeTypes,f=s.getPreviewTemplate(d),v=M(d,s.previewSettings)?s.previewSettings[d]:L[d],h=parseInt(s.wrapTextLength,10),m=s.wrapIndicator,g=p.indexOf(d)>=0,w=R(u)||!R(u)&&u.indexOf(e.type)!==-1,b=s.renderFileFooter(c,v.width),x="",C=t.slice(t.lastIndexOf("-")+1);g&&w?("text"===d?(r=Z(i.target.result),q.revokeObjectURL(a),r.length>h&&(l="text-"+N(),o=.75*window.innerHeight,x=s.getLayoutTemplate("modal").repl("{id}",l).repl("{title}",c).repl("{height}",o).repl("{body}",r),m=m.repl("{title}",c).repl("{dialog}","$('#"+l+"').modal('show')"),r=r.substring(0,h-1)+m),n=f.repl("{previewId}",t).repl("{caption}",c).repl("{frameClass}","").repl("{type}",e.type).repl("{width}",v.width).repl("{height}",v.height).repl("{data}",r).repl("{footer}",b).repl("{fileindex}",C)+x):n=f.repl("{previewId}",t).repl("{caption}",c).repl("{frameClass}","").repl("{type}",e.type).repl("{data}",a).repl("{width}",v.width).repl("{height}",v.height).repl("{footer}",b).repl("{fileindex}",C),s.$preview.append("\n"+n),s.autoSizeImage(t)):s.previewDefault(e,t)}},slugDefault:function(e){return R(e)?"":e.split(/(\\|\/)/g).pop().replace(/[^\w\u00C0-\u017F\-.\\\/ ]+/g,"")},getFileStack:function(){var e=this;return e.filestack.filter(function(e){return void 0!==e})},readFiles:function(e){function i(h){if(R(a.attr("multiple"))&&(p=1),h>=p)return t.isUploadable&&t.filestack.length>0?t.raise("filebatchselected",[t.getFileStack()]):t.raise("filebatchselected",[e]),l.removeClass("loading"),void o.html("");var m,g,w,b,x,C,y=f+h,T=c+"-"+y,E=e[h],F=t.slug(E.name),k=(E.size||0)/1e3,I="",D=q.createObjectURL(E),P=0,S=t.allowedFileTypes,U=R(S)?"":S.join(", "),j=t.allowedFileExtensions,A=R(j)?"":j.join(", ");if(R(j)||(I=new RegExp("\\.("+j.join("|")+")$","i")),k=k.toFixed(2),t.maxFileSize>0&&k>t.maxFileSize)return b=t.msgSizeTooLarge.repl("{name}",F).repl("{size}",k).repl("{maxSize}",t.maxFileSize),void(t.isError=v(b,E,T,h));if(!R(S)&&z(S)){for(w=0;w<S.length;w+=1)x=S[w],g=u[x],C=void 0!==g&&g(E.type,F),P+=R(C)?0:C.length;if(0===P)return b=t.msgInvalidFileType.repl("{name}",F).repl("{types}",U),void(t.isError=v(b,E,T,h))}return 0!==P||R(j)||!z(j)||R(I)||(C=F.match(I),P+=R(C)?0:C.length,0!==P)?t.showPreview?(n.length>0&&void 0!==FileReader?(o.html(s.repl("{index}",h+1).repl("{files}",p)),l.addClass("loading"),r.onerror=function(e){t.errorHandler(e,F)},r.onload=function(e){t.previewFile(E,e,T,D),t.initFileActions()},r.onloadend=function(){b=d.repl("{index}",h+1).repl("{files}",p).repl("{percent}",50).repl("{name}",F),setTimeout(function(){o.html(b),q.revokeObjectURL(D)},100),setTimeout(function(){i(h+1),t.updateFileDetails(p)},100),t.raise("fileloaded",[E,T,h,r])},r.onprogress=function(e){if(e.lengthComputable){var i=e.loaded/e.total*100,t=Math.ceil(i);b=d.repl("{index}",h+1).repl("{files}",p).repl("{percent}",t).repl("{name}",F),setTimeout(function(){o.html(b)},100)}},m=M("text",u)?u.text:O.text,m(E.type,F)?r.readAsText(E,t.textEncoding):r.readAsArrayBuffer(E)):(t.previewDefault(E,T),setTimeout(function(){i(h+1),t.updateFileDetails(p)},100),t.raise("fileloaded",[E,T,h,r])),void t.filestack.push(E)):(t.filestack.push(E),setTimeout(i(h+1),100),void t.raise("fileloaded",[E,T,h,r])):(b=t.msgInvalidFileExtension.repl("{name}",F).repl("{extensions}",A),void(t.isError=v(b,E,T,h)))}this.reader=new FileReader;var t=this,a=t.$element,n=t.$preview,r=t.reader,l=t.$previewContainer,o=t.$previewStatus,s=t.msgLoading,d=t.msgProgress,c=t.previewInitId,p=e.length,u=t.fileTypeSettings,f=t.filestack.length,v=function(i,a,n,r){var l=$.extend(t.getOutData({},{},e),{id:n,index:r}),o={id:n,index:r,file:a,files:e};return t.previewDefault(a,n,!0),t.isUploadable?t.showUploadError(i,l):t.showError(i,o)};i(0),t.updateFileDetails(p,!1)},updateFileDetails:function(e){var t=this,a=t.$element,n=t.getFileStack(),r=a.val()||n.length&&n[0].name||"",l=t.slug(r),o=t.isUploadable?n.length:e,s=i.count(t.id)+o,log=o>1?t.getMsgSelected(s):l;t.isError?(t.$previewContainer.removeClass("loading"),t.$previewStatus.html(""),t.$captionContainer.find(".kv-caption-icon").hide()):t.showFileIcon(),t.setCaption(log,t.isError),t.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&t.raise("fileselect",[e,l]),i.count(t.id)&&t.initPreviewDeletes()},change:function(e){var t=this,a=t.$element;if(!t.isUploadable&&R(a.val())&&t.fileInputCleared)return void(t.fileInputCleared=!1);t.fileInputCleared=!1;var n,r,l,o,s=t.$preview,d=arguments.length>1,c=d?e.originalEvent.dataTransfer.files:a.get(0).files,p=R(a.attr("multiple")),u=0,f=0,v=t.filestack.length,h=t.isUploadable,m=function(e,i,a,n){var r=$.extend(t.getOutData({},{},c),{id:a,index:n}),l={id:a,index:n,file:i,files:c};return t.isUploadable?t.showUploadError(e,r):t.showError(e,l)};if(t.reader=null,t.resetUpload(),t.hideFileIcon(),t.isUploadable&&t.$container.find(".file-drop-zone ."+t.dropZoneTitleClass).remove(),d)for(n=[];c[u];)o=c[u],o.type||o.size%4096!==0?n.push(o):f++,u++;else n=void 0===e.target.files?e.target&&e.target.value?[{name:e.target.value.replace(/^.+\\/,"")}]:[]:e.target.files;if(R(n)||0===n.length)return h||t.clear(),t.showFolderError(f),void t.raise("fileselectnone");if(t.resetErrors(),!h||p&&v>0){if(!t.overwriteInitial&&i.count(t.id)){var g=i.out(t.id);s.html(g.content),t.setCaption(g.caption),t.initPreviewDeletes()}else s.html("");p&&v>0&&(t.filestack=[])}return l=t.isUploadable?t.getFileStack().length+n.length:n.length,t.maxFileCount>0&&l>t.maxFileCount?(r=t.msgFilesTooMany.repl("{m}",t.maxFileCount).repl("{n}",l),t.isError=m(r,null,null,null),t.$captionContainer.find(".kv-caption-icon").hide(),t.$caption.html(t.msgValidationError),t.setEllipsis(),void t.$container.removeClass("file-input-new file-input-ajax-new")):(t.isIE9?t.updateFileDetails(1):t.readFiles(n),void t.showFolderError(f))},autoSizeImage:function(e){var i,t,a,n=this,r=n.$preview,l=r.find("#"+e),o=l.find("img");o.length&&o.on("load",function(){i=l.width(),t=r.width(),i>t&&(o.css("width","100%"),l.css("width","97%")),a=o.closest(".file-preview-frame").find(".file-caption-name"),a.length&&(a.width(o.width()),a.attr("title",a.text())),n.raise("fileimageloaded",e)})},initCaption:function(){var e=this,i=e.initialCaption||"";return e.overwriteInitial||R(i)?(e.$caption.html(""),!1):(e.setCaption(i),!0)},setCaption:function(e,i){var t,a,n=this,r=i||!1;if(r)t=$("<div>"+n.msgValidationError+"</div>").text(),a='<span class="'+n.msgValidationErrorClass+'">'+n.msgValidationErrorIcon+t+"</span>";else{if(R(e)||0===n.$caption.length)return;t=$("<div>"+e+"</div>").text(),a=n.getLayoutTemplate("icon")+t}n.$caption.html(a),n.$caption.attr("title",t),n.$captionContainer.find(".file-caption-ellipsis").attr("title",t),n.setEllipsis()},initBrowse:function(e){var i=this;i.$btnFile=e.find(".btn-file"),i.$btnFile.append(i.$element)},createContainer:function(){var e=this,i=$(document.createElement("span")).attr({"class":"file-input file-input-new"}).html(e.renderMain());return e.$element.before(i),e.initBrowse(i),i},refreshContainer:function(){var e=this,i=e.$container;i.before(e.$element),i.html(e.renderMain()),e.initBrowse(i)},renderMain:function(){var e=this,i=e.isUploadable&&e.dropZoneEnabled?" file-drop-zone":"",t=e.showPreview?e.getLayoutTemplate("preview").repl("{class}",e.previewClass).repl("{dropClass}",i):"",a=e.isDisabled?e.captionClass+" file-caption-disabled":e.captionClass,n=e.captionTemplate.repl("{class}",a+" kv-fileinput-caption");return e.mainTemplate.repl("{class}",e.mainClass).repl("{preview}",t).repl("{caption}",n).repl("{upload}",e.renderUpload()).repl("{remove}",e.renderRemove()).repl("{cancel}",e.renderCancel()).repl("{browse}",e.renderBrowse())},renderBrowse:function(){var e=this,i=e.browseClass+" btn-file",t="";return e.isDisabled&&(t=" disabled "),'<div class="'+i+'"'+t+"> "+e.browseIcon+e.browseLabel+" </div>"},renderRemove:function(){var e=this,i=e.removeClass+" fileinput-remove fileinput-remove-button",t="";return e.showRemove?(e.isDisabled&&(t=" disabled "),'<button type="button" title="'+e.removeTitle+'" class="'+i+'"'+t+">"+e.removeIcon+e.removeLabel+"</button>"):""},renderCancel:function(){var e=this,i=e.cancelClass+" fileinput-cancel fileinput-cancel-button";return e.showCancel?'<button type="button" title="'+e.cancelTitle+'" class="hide '+i+'">'+e.cancelIcon+e.cancelLabel+"</button>":""},renderUpload:function(){var e=this,i=e.uploadClass+" kv-fileinput-upload fileinput-upload-button",t="",a="";return e.showUpload?(e.isDisabled&&(a=" disabled "),t=!e.isUploadable||e.isDisabled?'<button type="submit" title="'+e.uploadTitle+'"class="'+i+'"'+a+">"+e.uploadIcon+e.uploadLabel+"</button>":'<a href="'+e.uploadUrl+'" title="'+e.uploadTitle+'" class="'+i+'"'+a+">"+e.uploadIcon+e.uploadLabel+"</a>"):""}},$.fn.fileinput=function(i){if(a()||e(9)){var t=Array.apply(null,arguments);return t.shift(),this.each(function(){var e=$(this),a=e.data("fileinput"),n="object"==typeof i&&i;a||(a=new H(this,$.extend({},$.fn.fileinput.defaults,n,$(this).data())),e.data("fileinput",a)),"string"==typeof i&&a[i].apply(a,t)})}},$.fn.fileinput.defaults={showCaption:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,mainClass:"",previewClass:"",captionClass:"",mainTemplate:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,layoutTemplates:U,previewTemplates:j,allowedPreviewTypes:A,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,customLayoutTags:{},customPreviewTags:{},previewSettings:L,fileTypeSettings:O,previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',browseIcon:'<i class="glyphicon glyphicon-folder-open"></i> &nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i> ',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i> ',cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i> ',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:!0,uploadExtraData:{},maxFileSize:0,minFileCount:0,maxFileCount:0,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",previewFileType:"image",wrapTextLength:250,wrapIndicator:' <span class="wrap-indicator" title="{title}" onclick="{dialog}">[&hellip;]</span>',elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0},$.fn.fileinput.locales={},$.fn.fileinput.locales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>. Please retry your upload!',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload. Please retry your upload!",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>. Please retry your upload!",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgValidationError:"File Upload Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",dropZoneTitle:"Drag & drop files here &hellip;"},$.extend($.fn.fileinput.defaults,$.fn.fileinput.locales.en),$.fn.fileinput.Constructor=H,$(document).ready(function(){var e=$("input.file[type=file]"),i=e.attr("type")?e.length:0;i>0&&e.fileinput()})}(window.jQuery);