var Login=function(){var e=function(e,r){},r=function(){$(".login-form").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!1,rules:{hy_username:{required:!0,digits:!0},hy_password:{required:!0},remember:{required:!1}},messages:{hy_username:{required:"用户名不可为空！"},hy_password:{required:"密码不可为空！"}},invalidHandler:function(e,r){},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},errorPlacement:function(e,r){e.insertAfter(r.closest(".input-icon"))},submitHandler:function(r){Metronic.blockUI({message:"请稍后...",target:$(".login-form"),cenrerY:!0,boxed:!0,overlayColor:"none"});var o=$.trim($('[name="hy_username"]').val()),t=crypto_sha1($.trim($('[name="hy_password"]').val())+$("#login-addon").val());return $.ajax({url:$.U("ajax?q=login"),data:{u:crypto_aes(o,$("#login-key").val()),p:crypto_aes(t,t.substr(5,32))},type:"POST",timeout:5e3,success:function(r){if(console.log(r),e(r,".login-form"),!r.status)return Metronic.unblockUI($(".login-form")),$('[name="hy_password"]').val("").focus(),!1;$('[name="remember"]').prop("checked")?$.store.set("HyFrame_loginAccount",o):$.store.remove("HyFrame_loginAccount"),$.store.set("_homyit_token_counter_",r.data);var n=crypto_sha1(t+"#"+r.data).substr(7,32);$.store.set("_homyit_token_seed_",n),setTimeout(function(){location.href=$.U("Index/index")},100)},error:function(){e({status:!1,info:"登录失败，请重试！"},".login-form"),Metronic.unblockUI($(".login-form"))}}),!1}}),$(".login-form input").keypress(function(e){if(13==e.which)return $(".login-form").validate().form()&&$(".login-form").submit(),!1})},o=function(){$(".forget-form").validate({errorElement:"span",errorClass:"help-block",debug:!0,focusInvalid:!1,rules:{forget_username:{required:!0,digits:!0},forget_email:{required:!0,email:!0},forget_password:{required:!0,minlength:6}},messages:{forget_username:{required:"用户名不可为空！"},forget_email:{required:"邮箱地址不可为空！",email:"邮箱地址不合法！"},forget_password:{required:"新密码不可为空！",minlength:"密码长度不可少于6位！"}},invalidHandler:function(e,r){},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},errorPlacement:function(e,r){e.insertAfter(r.closest(".input-icon"))},submitHandler:function(r){var o=$('[name="forget_verify"]').val();return o?(Metronic.blockUI({message:"请稍后...",target:$(".forget-form"),cenrerY:!0,boxed:!0}),$.post($.U("ajax?q=forgetRestPwd"),{u:crypto_base64($('[name="forget_username"]').val()),v:o,p:crypto_sha1($.trim($('[name="forget_password"]').val()))},function(r){Metronic.unblockUI($(".forget-form")),$('[name="forget_username"]').prop("disabled",!1),$('[name="forget_email"]').val("").prop("disabled",!1),$(".forget-form .after-send").hide(),$('[name="forget_verify"]').val(""),$('[name="forget_password"]').val(""),$(".forget-form .after-send").hide(),r.status?(e(r,".login-form"),$("#back-btn").trigger("click")):e(r,".forget-form")})):(Metronic.blockUI({message:"已发送，请耐心等待...",target:$(".forget-form"),cenrerY:!0,boxed:!0}),$.post($.U("ajax?q=forgetSendVerify"),{u:crypto_aes($.trim($('[name="forget_username"]').val()),$("#login-key").val()),e:crypto_sha1($.trim($('[name="forget_email"]').val()))},function(r){return Metronic.unblockUI($(".forget-form")),e(r,".forget-form"),r.status?($('[name="forget_username"]').prop("disabled",!0),$('[name="forget_email"]').prop("disabled",!0),$(".forget-form .after-send").show(),void 0):($('[name="forget_email"]').focus(),!1)})),!1}}),$(".forget-form input").keypress(function(e){if(13==e.which)return $(".forget-form").validate().form()&&$(".forget-form").submit(),!1}),$("#forget-password").click(function(){$('[name="forget_username"]').val($('[name="hy_username"]').val()),$(".login-form").hide(),$(".forget-form").show()}),$("#back-btn").click(function(){$('[name="hy_username"]').val($('[name="forget_username"]').val()),$(".forget-form").hide(),$(".login-form").show()})},t=function(){var e=$.store.get("HyFrame_loginAccount");e?($('[name="hy_username"]').val(e),$('[name="remember"]').attr("checked",!0),$.uniform.update('[name="remember"]'),$('[name="hy_password"]').focus()):$('[name="hy_username"]').focus()},n=function(){if(!($(window).width()<480)){var e=Metronic.getGlobalImgPath();$.backstretch([e+"bg/1.jpg",e+"bg/2.jpg",e+"bg/3.jpg",e+"bg/4.jpg"],{fade:1e3,duration:6e3})}},a=function(){if(/msie\s[67]/.test(navigator.userAgent.toLowerCase())){var e=['<h3 class="text-danger">检测到您的浏览器不支持HTML5的某些功能，这会影响到您访问本站的体验。',"我们强烈推荐您使用Chrome内核（如最新版360安全浏览器、360极速浏览器、","猎豹浏览器等的极速模式、谷歌等）浏览器、火狐等现代浏览器登录系统！或者请您使用IE9.0以上版本访问本站！</h3>"].join("");bootbox.alert(e)}};return{init:function(){a(),t(),r(),o(),n()}}}();